---
title: å‰ç«¯å·¥ç¨‹å¸«åœ¨GitHubä¸ŠæŒçºŒæ•´åˆèˆ‡éƒ¨ç½²(CI/CD)
category: blog
date: '2019-02-07T16:00:00.000Z'
description: "é€™ç¯‡æ–‡ç« è¨˜éŒ„äº†å‰ç«¯å·¥ç¨‹å¸«å¦‚ä½•åŠ å…¥æŒçºŒæ•´åˆèˆ‡éƒ¨ç½²åœ¨è‡ªå·±çš„å°ˆæ¡ˆä¸­"
banner: './images/banner.jpeg'
bannerCredit: Photo by [kazuend](https://unsplash.com/@kazuend) on [Unsplash](https://unsplash.com/)
tags:
  - CI/CD
  - Front End Development
---

## å‰è¨€

ç¾åœ¨çš„å‰ç«¯å·¥ç¨‹å¸«éœ€è¦å¯¦ç¾çš„åŠŸèƒ½è¶Šä¾†è¶Šè¤‡é›œï¼Œè¤‡é›œåº¦è¶Šé«˜ä»£è¡¨å‡ºéŒ¯çš„æ©Ÿç‡ä¹Ÿæœƒè·Ÿè‘—æå‡ï¼Œé‚£éº¼â€¦æœ‰æ²’æœ‰ä»€éº¼æ–¹æ³•å¯ä»¥æ”¹å–„å‘¢ï¼Ÿç•¶ç„¶æœ‰å•¦ï¼å°±æ˜¯åœ¨æ¯æ¬¡ç™¼å¸ƒæ–°ç‰ˆç¨‹å¼æ™‚è®“æ¸¬è©¦ç¨‹å¼è‡ªå‹•å¹«æˆ‘å€‘å®Œæˆé€™äº›é‡è¤‡æ€§æ¥µé«˜çš„å·¥ä½œï¼

ğŸ‘‡ æ¥ä¸‹ä¾†è¦é€éä¸‹é¢å¹¾å€‹æ­¥é©Ÿå¯¦ç¾æŒçºŒæ•´åˆèˆ‡éƒ¨ç½²çš„å·¥ä½œ ğŸ‘‡

* Lint test (ç¨‹å¼ç¢¼é¢¨æ ¼æ¸¬è©¦) : [StandardJS](https://standardjs.com/)
* Unit test (å–®å…ƒæ¸¬è©¦) : [Jest](https://jestjs.io/), [Enzyme](https://airbnb.io/enzyme/docs/guides/jest.html)
* Functional test (åŠŸèƒ½æ¸¬è©¦) : [Codeceptjs](https://codecept.io/), [WebDriverIO](https://codecept.io/helpers/WebDriverIO/)
* Visual test (è¦–è¦ºæ¸¬è©¦) : [Applitools](https://applitools.com/)
* Compatibility test (å…¼å®¹æ€§æ¸¬è©¦) : [Sauce Labs](https://saucelabs.com/)
* Deploy (éƒ¨ç½²) : [GitHub Pages](https://pages.github.com/)
* Continuous integration (æŒçºŒæ•´åˆ) : [Travis CI](https://travis-ci.org/)

## ç’°å¢ƒè¨­å®š

è«‹å…ˆç¢ºèªç’°å¢ƒä¸­å·²å®‰è£

1. [Git](https://git-scm.com/downloads)
1. [Node.js](https://nodejs.org/en/)

## **å¾ç¯„ä¾‹é–‹å§‹**

é€™è£¡æœ‰ä¸€å€‹ç°¡å–®çš„ç¶²ç«™ä¸¦é™„ä¸Šéƒ¨åˆ†æ¸¬è©¦ç¨‹å¼ï¼Œå»ºè­°ä½¿ç”¨ [test-app-starter](https://github.com/sky172839465/test-app-starter) ä¾†å¿«é€Ÿé«”é©—æ•´å€‹æ¸¬è©¦æµç¨‹ï¼Œé€™å€‹å°ˆæ¡ˆæ˜¯ç”¨ [create-react-app](https://github.com/facebook/create-react-app) å»ºç«‹çš„ï¼Œä½†æ˜¯é€™ç¯‡æ•™å­¸ä¸­æ‰€æœ‰åŠŸèƒ½åœ¨ React, Angular, Vue çš†å¯ä»¥ä½¿ç”¨ã€‚

åˆ° [test-app-starter](https://github.com/sky172839465/test-app-starter) é»é¸ Fork ä¸€ä»½åˆ°è‡ªå·±çš„å¸³è™Ÿåº•ä¸‹æ“ä½œï¼Œæ­¥é©Ÿä¸Šçš„ä¿®æ”¹å¯ä»¥åƒè€ƒ test-app-starter çš„ [demo branch](https://github.com/sky172839465/test-app-starter/commits/demo)

![é»é¸ Fork](./images/github-fork-project.png)
<!-- <iframe src="https://medium.com/media/1a43b8fe1e602f107883e356aa465b6a" frameborder=0></iframe> -->

> GITHUB_USER_NAME = ä½ çš„ GitHub å¸³è™Ÿ

è¤‡è£½ test-app-starter åˆ°æœ¬æ©Ÿ
```bash
$ git clone https://github.com/<GITHUB_USER_NAME>/test-app-starter.git
```
åˆ‡æ›åˆ° test-app-starter ç›®éŒ„
```bash
$ cd test-app-starter
```
ğŸ‘‹ Windows ç’°å¢ƒè«‹å…ˆåœ¨ `test-app-starter` ç›®éŒ„åŸ·è¡Œåº•ä¸‹æŒ‡ä»¤ç¢ºä¿å¯ä»¥åŸ·è¡Œ shell script : [ä¾†æº]

ğŸ‘‹ è«‹å…ˆç¢ºèªå·²å®‰è£ [Git]

X86
```bash
$ npm config set script-shell "C:\\Program Files (x86)\\git\\bin\\bash.exe"
```
X64
```bash
$ npm config set script-shell "C:\\Program Files\\git\\bin\\bash.exe"
```

[ä¾†æº]: https://stackoverflow.com/a/46006249/5003128
[Git]: https://git-scm.com/downloads
å®‰è£ä¾è³´å¥—ä»¶
```bash
$ npm install
```
å•Ÿå‹• test-app-starter ç¶²ç«™
```bash
$ npm start
```


æ¥è‘—æ‡‰è©²å¯ä»¥çœ‹åˆ°ç¶²ç«™åœ¨ [localhost:3000](http://localhost:3000) ä¸ŠåŸ·è¡Œ

![](./images/running.png)

## **Lint test**

ç¨‹å¼ç¢¼é¢¨æ ¼æ¸¬è©¦ç”¨ä¾†çµ±ä¸€å”ä½œè‘—çš„æ’°å¯«é¢¨æ ¼ï¼Œé–‹ç™¼è€…å€‘æœ‰ä¸€è‡´çš„æ’°å¯«é¢¨æ ¼å¯ä»¥è®“æ¥æ‰‹çš„å·¥ç¨‹å¸«æˆ–æ˜¯å”ä½œçš„å·¥ç¨‹å¸«æ›´å¥½ä¸Šæ‰‹ï¼Œé€™å€‹ç¶²ç«™å·²ç¶“ç”¨ StandardJS çš„é¢¨æ ¼æ’°å¯«ï¼Œæ‰€ä»¥æ¥ä¸‹ä¾†åªéœ€è¦è¨­å®šå¥½ç›¸é—œè¨­å®šå°±å¯ä»¥é€²è¡Œç¨‹å¼ç¢¼é¢¨æ ¼æ¸¬è©¦äº†ã€‚

å®‰è£ StandardJS åˆ°å°ˆæ¡ˆä¸­
```bash
$ npm install --save-dev standard snazzy
```
`package.json` çš„ `scripts` å¢åŠ  `lint` çš„è…³æœ¬èˆ‡ `standard` çš„è¨­å®š
```json
"scripts": {
  "lint": "standard | snazzy"
},
"standard": {
  "ignore": [
    "build/*",
    "registerServiceWorker.js"
  ],
  "env": {
    "browser": true,
    "jest": true
  },
  "parser": "babel-eslint",
  "globals": [
    "actor",
    "Feature",
    "Scenario"
  ]
}
```
åŸ·è¡Œ `lint` è…³æœ¬
```bash
$ npm run lint
```

æ¥è‘—æ‡‰è©²å¯ä»¥çœ‹åˆ°â€¦ä»€éº¼éƒ½æ²’ç™¼ç”Ÿ ğŸ˜…ï¼Œä½†æ˜¯é€™å°±æ˜¯é¢¨æ ¼ä¸€è‡´çš„æ„æ€â€¦
> æ²’æœ‰æ¶ˆæ¯å°±æ˜¯å¥½æ¶ˆæ¯


![](./images/lint-success.png)

æ‰€ä»¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ lint çš„è…³æœ¬ï¼Œè®“åŸ·è¡Œçµæœæ˜ç¢ºä¸€é»

`package.json` è£¡ `scripts` ä¿®æ”¹ `lint` çš„è…³æœ¬
```json
"scripts": {
  "lint": "if standard | snazzy; then echo 'ğŸ’¯ Lint perfect'; else echo 'â‰ï¸ Lint get error please run `npm run lint` check again';exit 1; fi"
}
```
å†æ¬¡æª¢åŸ·è¡Œ
```bash
$ npm run lint
```

åŸ·è¡ŒæˆåŠŸå¾Œæ‡‰è©²åœ¨çµ‚ç«¯æ©Ÿå¯ä»¥çœ‹åˆ° ã€ŒğŸ’¯ Lint perfectã€

![](./images/lint-success-with-emoji.png)

å±•ç¤ºï¼š[Update for lint test](https://github.com/sky172839465/test-app-starter/commit/c0e9fe1d1c04db9115e614c708a4cb15eb9e4d1d)

## Unit test

å–®å…ƒæ¸¬è©¦ç”¨ä¾†æ¸¬è©¦ function å›å‚³çš„è³‡æ–™æ˜¯å¦å’Œé æœŸçš„ç›¸åŒï¼Œåœ¨é–‹ç™¼çš„æ™‚å€™å¯ä»¥å¿«é€Ÿæª¢æŸ¥å¤šç¨®æƒ…æ³ä¸‹è¼¸å‡ºæ˜¯å¦ç¬¦åˆé æœŸï¼Œåœ¨æ—¢æœ‰çš„ function å¢æ¸›åŠŸèƒ½æ™‚ä¹Ÿèƒ½å¹«åŠ©åˆ¤æ–·ä¿®æ”¹å¾Œèƒ½å¦å…¼å®¹èˆŠçš„ç¨‹å¼ã€‚
> æ¸¬è©¦å°±æ˜¯æœ€å¥½çš„æ–‡ä»¶

ç•¶ä¸€å€‹å°ˆæ¡ˆè¶Šä¾†è¶Šå¤§æœ‰æ˜ç¢ºçš„æ¸¬è©¦æ‰èƒ½è®“åˆ¥äººæ¸…æ¥šçŸ¥é“é€™å€‹ function åˆ°åº•åœ¨å¹¹å˜› ğŸ¤”

å®‰è£ä¾è³´å¥—ä»¶
```bash
$ npm install --save-dev enzyme enzyme-adapter-react-16 enzyme-to-json @types/jest 
```
`package.json` è£¡ `scripts` ä¿®æ”¹ `test` è…³æœ¬ï¼Œå¢åŠ  `jest` çš„è¨­å®š
```json
"scripts": {
  "test": "if CI=true react-scripts test --coverage --env=jsdom; then echo 'âœ… Unit test run success'; else echo 'âŒ Unit test run failure'; exit 1; fi"
},
"jest": {
  "snapshotSerializers": [
    "enzyme-to-json/serializer"
  ],
  "collectCoverageFrom": [
    "src/**/*.js",
    "!src/__tests__/**/*",
    "!src/__e2e__/**/*",
    "!src/(App|index|serviceWorker|setupTests).js"
  ],
  "coverageReporters": [
    "text",
    "lcov"
  ]
}
```
åŸ·è¡Œè…³æœ¬
```bash
$ npm run test
```

åŸ·è¡ŒæˆåŠŸå¾Œæ‡‰è©²åœ¨çµ‚ç«¯æ©Ÿå¯ä»¥çœ‹åˆ° ã€Œâœ… Unit test run successã€

![](./images/unit-success.png)

å±•ç¤ºï¼š[Update for unit test](https://github.com/sky172839465/test-app-starter/commit/8f1e6d55c8c24e34f743e2e34e8bbd73688278b5)

## Functional test + Visual test

åŠŸèƒ½æ¸¬è©¦ç”¨ä¾†æ¸¬è©¦ç¶²ç«™åœ¨æ“ä½œæ™‚èƒ½ä¸èƒ½å¦‚é æœŸåŸ·è¡Œï¼Œä¾‹å¦‚ä¸€å€‹æŸ¥è©¢ä»‹é¢ï¼ŒæŸ¥è©¢æ™‚æŸ¥è©¢æŒ‰éˆ•è®Šæˆ disabled ï¼ŒæŸ¥è©¢æˆåŠŸæ™‚é¡¯ç¤ºæŸ¥è©¢çµæœä¸”æŒ‰éˆ•è®Šå› enabled ã€‚

è¦–è¦ºæ¸¬è©¦ç”¨ä¾†æª¢æŸ¥ç¶²ç«™è·Ÿä¸Šä¸€æ¬¡çš„æ¨£å¼æœ‰æ²’æœ‰ç”¢ç”Ÿè®ŠåŒ–ï¼Œé€™æ¨£å¯ä»¥é¿é¢èª¿æ•´æŸä¸€å€‹ CSS çš„æ™‚å€™çªç„¶å½±éŸ¿åˆ°å…¶ä¸­ä¸€é æ²’æœ‰é æƒ³åˆ°çš„ç•«é¢é€ æˆç•«é¢ä¸å¦‚é æœŸâ€¦ğŸ¤­

å®‰è£ä¾è³´å¥—ä»¶
```bash
$ npm install @applitools/eyes.webdriverio codeceptjs selenium-standalone webdriverio@4.14.1
```
`package.json` è£¡ `scripts` å¢åŠ 3å€‹è…³æœ¬
```json
scripts: {
  "functional::local": "npm run start:selenium && codeceptjs run --steps --config=./codecept/local.config.js",
  "install:selenium": "selenium-standalone install",
  "start:selenium": "selenium-standalone start > /dev/null 2>&1 &",
  "kill:selenium": "lsof -t -i :4444 | xargs kill"
}
```
åŸ·è¡Œåº•ä¸‹æŒ‡ä»¤å®‰è£ selenium çš„ä¾è³´å¥—ä»¶
```bash
$ npm run install:selenium
```
åœ¨ `test-app-starter` æ ¹ç›®éŒ„æ–°å¢ `codecept` ç›®éŒ„ä¸¦æ–°å¢4å€‹æª”æ¡ˆ

1. `./codecept/local.config.js`
    ```js
    exports.config = {
      name: 'test-app',
      tests: '../src/__e2e__/src/**/**.js',
      output: '../report',
      helpers: {
        EyesHelper: { require: './helper/eyesHelper.js' },
        WebDriverIO: {
          url: 'http://localhost:3000',
          browser: 'chrome',
          waitForTimeout: 300000
        }
      },
      include: {
        I: './actor/steps_file.js'
      },
      bootstrap: false,
      coloredLogs: true
    }
    ```

2. `./codecept/commonData.js`
    ```js
    const now = new Date()
    const startDate = `${now.getFullYear()}/${now.getMonth() + 1}/${now.getDate()}`
    const startTime = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`
    const {
      PROJECT_NAME = 'Test app',
      SAUCE_USERNAME,
      SAUCE_ACCESS_KEY,
      EYES_KEY,
      BASE_URL = 'https://sky172839465.github.io/test-app',
      TRAVIS_BUILD_NUMBER = `local ${startDate} ${startTime}`,
      TRAVIS_JOB_NUMBER = ''
    } = process.env

    module.exports = {
      PROJECT_NAME,
      SAUCE_USERNAME,
      SAUCE_ACCESS_KEY,
      EYES_KEY,
      BASE_URL,
      TRAVIS_BUILD_NUMBER,
      TRAVIS_JOB_NUMBER
    }
    ```

3. `./codecept/actor/steps_file.js`
    ```js
    module.exports = () => {
      return actor({
        say: (message) => {
          console.log(message)
        }
      })
    }
    ```

4. `./codecept/helper/eyesHelper.js`
    ```javascript
    const codecept = require('codeceptjs')
    const { Eyes, Target } = require('@applitools/eyes.webdriverio')
    const Helper = codecept.helper
    const {
      EYES_KEY,
      PROJECT_NAME
    } = require('../commonData')

    class EyesHelper extends Helper {
      constructor (config) {
        super(config)
        this.eyes = new Eyes()
        this.eyes.setApiKey(EYES_KEY)
        this.browser = null
        this.suiteTitle = null
        this.scenarioTitle = null
        this.isNewTest = true
        this.isEyesOpen = false
        this.step = 0
      }

      _getBrowser () {
        return this.helpers['WebDriverIO'].browser
      }

      _beforeSuite ({ title }) {
        this.suiteTitle = title
      }

      _before ({ title }) {
        this.scenarioTitle = title
        this.isNewTest = true
        this.step = 0
      }

      _afterSuite () {
        this.suiteTitle = null
      }

      async _after () {
        this.scenarioTitle = null
        if (this.isEyesOpen) {
          this.isEyesOpen = false
          try {
            await this.eyes.close()
          } finally {
            await this.eyes.abortIfNotClosed()
          }
        }
      }

      async screenShotForVisualTest (appName = `${this.suiteTitle}:${this.scenarioTitle}`, stepName = `Step:${this.step}`) {
        if (this.isNewTest) {
          this.browser = this._getBrowser()
          await this.eyes.open(
            this.browser,
            appName,
            PROJECT_NAME
          )
          this.isEyesOpen = true
          this.isNewTest = false
        }
        await this.eyes.check(stepName, Target.window())
        this.step += 1
      }
    }

    module.exports = EyesHelper
    ```

1. local.config.js : åœ¨æœ¬æ©Ÿçš„ [codeceptjs](https://codecept.io/configuration/) çš„è¨­å®š
1. commonData.js : æ”¾å…±ç”¨çš„è®Šæ•¸
1. steps_file.js : functional test ä¸­ä½¿ç”¨çš„èªæ„ API ï¼Œ I.xxx æ“´å……åŠŸèƒ½å¯ä»¥åœ¨é€™é‚Šæ–°å¢
1. eyesHelper : è¦–è¦ºæ¸¬è©¦ [Applitools](https://applitools.com/tutorials/webdriverio.html#run-your-first-test) çš„è¨­å®šï¼ŒåŸ·è¡Œ functional test æ™‚å¦‚æœæƒ³å°‡ç•¶æ™‚çš„çµæœæˆªåœ–ä¸‹ä¾†äº¤çµ¦ Applitools ä½œæ¯”è¼ƒåªè¦ç”¨å·²ç¶“æ”¹å¯«æˆèªæ„APIçš„ I.screenShotForVisualTest() å³å¯å°‡åœ–ç‰‡æˆªä¸‹ä¾†ä¸Šå‚³åˆ° Applitools çš„é›²ç«¯åšæ¯”è¼ƒ

ğŸ‘‹ å› ç‚º Applitools æ˜¯ä¸€å€‹æœå‹™ï¼Œæ‰€ä»¥éœ€è¦å…ˆåˆ° [Applitools](https://applitools.com/users/register) è¨»å†Šä¸€å€‹å¸³è™Ÿå–å¾— EYES_TOKEN æ‰èƒ½ä¸Šå‚³åˆ°è‡ªå·±çš„å¸³è™Ÿå…§åšæ¯”å°ï¼Œå»ºè­°ç›´æ¥ç”¨ GitHub å¸³è™Ÿè¨»å†Šä¸¦ç™»å…¥

![](./images/applitools-register.png)

æ¥è‘—é» My API Key å–å¾— EYES_TOKEN

![](./images/applitools-token.png)

å„²å­˜ `EYES_TOKEN`
```bash
# mac
$ export EYES_KEY=EYES_TOKEN
# windows
$ set EYES_KEY=EYES_TOKEN
```
ğŸ‘‹ ç¢ºå®š [localhost:3000][] ç¶²ç«™æœ‰å•Ÿå‹•ï¼Œå¦å‰‡è¨˜å¾—å…ˆåŸ·è¡Œ `npm start`

ğŸ‘‹ è«‹ç¢ºèªåŸ·è¡Œåº•ä¸‹è…³æœ¬çš„çµ‚ç«¯æ©Ÿæœ‰ `EYES_KEY` `SAUCE_USERNAME` `SAUCE_ACCESS_KEY` é€™å¹¾å€‹ç’°å¢ƒè®Šæ•¸ï¼Œå¯ä»¥ç”¨ `echo $EYES_KEY` åœ¨çµ‚ç«¯æ©Ÿæª¢æŸ¥
```bash
$ npm run functional::local
```

å¦‚æœé‡åˆ° [No Java runtime present](https://github.com/vvo/selenium-standalone/issues/140#issuecomment-151254279)ï¼Œè«‹æŒ‰ç…§ä¸Šé¢çš„èªªæ˜å®‰è£ Java

[localhost:3000]: http://localhost:3000

åŸ·è¡ŒæˆåŠŸå¾Œåœ¨çµ‚ç«¯æ©Ÿæ‡‰è©²å¯ä»¥çœ‹åˆ°

![](./images/functional-success.png)

åœ¨ [Applitools](https://eyes.applitools.com/app/test-results) é‡æ–°æ•´ç†å¾Œæ‡‰è©²å¯ä»¥çœ‹åˆ° functional test ä¸­ï¼ŒåŸ·è¡Œ3æ¬¡ I.screenShotForVisualTest() çš„æˆªåœ–ï¼Œ2å€‹ New ä»¥åŠ2å€‹ passed ï¼Œå› ç‚ºé€™æ˜¯ç¬¬ä¸€æ¬¡æˆªåœ–æ‰€ä»¥é€™æ¬¡çš„æˆªåœ–è¢«ç•¶æˆåŸºæº–ï¼Œæ¥è‘—å†è·‘ä¸€æ¬¡ï¼Œ New å°±æœƒæ¶ˆå¤±ï¼Œä»£è¡¨é€™æ¬¡æ˜¯è·Ÿä¸Šæ¬¡çš„åŸºæº–æ¯”å°éçš„ ğŸ‰

![ç¬¬ä¸€æ¬¡æˆªåœ–æ˜¯ã€ŒåŸºæº–ã€](./images/applitools-base.png)*ç¬¬ä¸€æ¬¡æˆªåœ–æ˜¯ã€ŒåŸºæº–ã€*

![ç¬¬äºŒæ¬¡æˆªåœ–æœƒå’Œã€ŒåŸºæº–ã€æ¯”è¼ƒ](./images/applitools-compare.png)*ç¬¬äºŒæ¬¡æˆªåœ–æœƒå’Œã€ŒåŸºæº–ã€æ¯”è¼ƒ*

å±•ç¤ºï¼š[Update for functional & visual test](https://github.com/sky172839465/test-app-starter/commit/7f6ca237bcd4b7ba1afb6841293a668e714894e6)

## Compatibility test

å…¼å®¹æ€§æ¸¬è©¦åœ¨å‰ç«¯æ˜¯æœ€ä¸æƒ³é¢å°çš„ä¸€ä»¶äº‹ ğŸ¤ ï¼Œä¸ç”¨å…¼å®¹æ˜¯æœ€å¥½çš„ï¼Œä½†æ˜¯è¬ä¸€è¦åšåˆ°å°±æœƒè®Šå¾—å¾ˆéº»ç…©ï¼Œä¸åŒç€è¦½å™¨ã€ä¸åŒç€è¦½å™¨ç‰ˆæœ¬ã€ä¸åŒä½œæ¥­ç³»çµ±â€¦å…‰ç”¨æƒ³çš„å°±ä¸€å€‹é ­å…©å€‹å¤§ ğŸ¤¯ ï¼Œå› æ­¤æˆ‘å€‘æ‰éœ€è¦å…¼å®¹æ€§æ¸¬è©¦ï¼

Sauce Labs æ˜¯ä¸€å€‹é›²ç«¯æœå‹™ï¼Œæä¾›æˆ‘å€‘å„ç¨®ä½œæ¥­ç³»çµ±ã€ç‰ˆæœ¬ã€ç€è¦½å™¨ï¼Œæˆ‘å€‘åªéœ€è¦æŠŠã€ŒåŠŸèƒ½æ¸¬è©¦ã€å’Œã€Œè¦–è¦ºæ¸¬è©¦ã€ä¸Ÿåˆ°ä¸Šé¢è®“ä»–è‡ªå·±è·‘å°±èƒ½çŸ¥é“è‡ªå·±çš„ç€è¦½å™¨å…¼å®¹åˆ°ä»€éº¼ç¨‹åº¦äº†ï¼ Sauce Labs é‚„æœƒå¹«æˆ‘å€‘éŒ„ä¸‹æ¸¬è©¦çš„éç¨‹å–”ï¼

é€™æ™‚æœƒé‡åˆ°2ç¨®ç‹€æ³ ï¼š

1. æœ¬æ©Ÿé–‹ç™¼æ™‚ç¶²ç«™åœ¨ localhost å°±å¯èƒ½éœ€è¦æª¢é©—ç¶²ç«™æœ‰æ²’æœ‰æ­£ç¢ºåœ¨å„ç¨®å¹³å°åŸ·è¡Œ
1. éƒ¨ç½²åˆ°ç·šä¸Šå¾Œè¦æ¸¬è©¦ç·šä¸Šçš„ç¶²ç«™æœ‰æ²’æœ‰è·Ÿæœ¬æ©Ÿä¸€æ¨£æ­£å¸¸

é¦–å…ˆæˆ‘å€‘å…ˆåœ¨æœ¬æ©Ÿé€²è¡Œæ¸¬è©¦ï¼Œéœ€è¦å…ˆåˆ° [Sauce Labs](https://saucelabs.com/oauth/login/github) è¨»å†Šä¸€å€‹å¸³è™Ÿï¼Œä¸¦åŒæ„ Sauce Labs å­˜å–å¸³è™Ÿæ¬Šé™

ğŸ‘‹ è¨˜å¾—å»ç”³è«‹ [Open Sauce](https://saucelabs.com/open-source/open-sauce) æ–¹æ¡ˆï¼Œåªè¦æŠŠå°ˆæ¡ˆæ¨™ç¤ºæˆ open source å°±å¯ä»¥ç”³è«‹äº†ï¼Œ Open Sauce çš„å¸³è™Ÿå¯ä»¥ç²å¾—æ²’æœ‰é™åˆ¶çš„ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½

![](./images/saucelabs-register.png)

é€²å…¥[è¨­å®šé ](https://app.saucelabs.com/user-settings)å–å¾— USER_NAME (USERNAME) åŠ SAUCE_TOKEN (Access Key)

![](./images/saucelabs-settings.png)

å„²å­˜ `USER_NAME` å’Œ `SAUCE_TOKEN`
```bash
# mac
$ export SAUCE_USERNAME=USER_NAME SAUCE_ACCESS_KEY=SAUCE_TOKEN
# windows
$ set SAUCE_USERNAME=USER_NAME
$ set SAUCE_ACCESS_KEY=SAUCE_TOKEN
```
å®‰è£ Sauce Labs çš„ä¾è³´å¥—ä»¶
```bash
$ npm install --save-dev codeceptjs-saucehelper saucelabs
```

æ¥è‘—æˆ‘å€‘è¦å¯«ä¸€äº› Sauce Labs çš„è¨­å®š

1. `./codecept/sauce.config.js`
    ```js
    const {
      PROJECT_NAME,
      SAUCE_USERNAME,
      SAUCE_ACCESS_KEY,
      BASE_URL,
      TRAVIS_JOB_NUMBER
    } = require('./commonData')
    const getBrowserConfig = browserName => ({
      'tunnel-identifier': TRAVIS_JOB_NUMBER,
      name: PROJECT_NAME,
      build: TRAVIS_JOB_NUMBER ? `build-${TRAVIS_JOB_NUMBER}` : `local-${Date.now()}`
    })

    exports.config = {
      name: 'test-app',
      tests: '../src/__e2e__/src/**/**.js',
      output: '../report',
      helpers: {
        SauceHelper: { require: './helper/sauceHelper.js' },
        EyesHelper: { require: './helper/eyesHelper.js' },
        WebDriverIO: {
          url: BASE_URL,
          user: SAUCE_USERNAME,
          key: SAUCE_ACCESS_KEY,
          browser: 'chrome',
          desiredCapabilities: {
            platform: 'Windows 10',
            ...getBrowserConfig('Windows Chrome')
          },
          windowSize: 'maximize',
          waitForTimeout: 30000
        }
      },
      include: {
        I: './actor/steps_file.js'
      },
      bootstrap: false,
      coloredLogs: true,
      timeout: 10000,
      smartWait: true
    }
    ```

Platform config: https://wiki.saucelabs.com/display/DOCS/Platform+Configurator#/

2. `./codecept/helper/sauceHelper.js`
    ```js
    const codecept = require('codeceptjs')
    const Helper = codecept.helper
    const SauceLabs = require('saucelabs')
    const {
      SAUCE_USERNAME,
      SAUCE_ACCESS_KEY
    } = require('../commonData')
    const Acct = new SauceLabs({
      username: SAUCE_USERNAME,
      password: SAUCE_ACCESS_KEY
    })

    // https://github.com/puneet0191/codeceptjs-saucehelpe
    class SauceHelper extends Helper {
      _updateSauceJob (sessionId, data) {
        const sauceUrl = `âš¡ï¸ Test finished. Link to job: https://saucelabs.com/jobs/${sessionId} âš¡ï¸\n\n`
        const {
          platform = 'unknown',
          browserName = 'unknown'
        } = this.helpers['WebDriverIO'].browser.desiredCapabilities
        const newData = {
          ...data,
          name: `(${platform}:${browserName}) ${data.name}`,
          public: 'public'
        }
        console.log(sauceUrl)
        Acct.updateJob(sessionId, newData, this._callback)
      }

      _callback (error, response, body) {
        if (!error && response.statusCode === 200) {
          console.log(body)
        }
      }

      _passed (test) {
        console.log('Test has Passed')
        const sessionId = this._getSessionId()
        this._updateSauceJob(sessionId, { 'passed': true, 'name': test.title })
      }

      _failed (test, error) {
        console.log('Test has failed')
        const sessionId = this._getSessionId()
        this._updateSauceJob(sessionId, { 'passed': false, 'name': test.title })
      }

      _getSessionId () {
        if (this.helpers['WebDriver']) {
          return this.helpers['WebDriver'].browser.sessionId
        }
        if (this.helpers['Appium']) {
          return this.helpers['Appium'].browser.sessionId
        }
        if (this.helpers['WebDriverIO']) {
          return this.helpers['WebDriverIO'].browser.requestHandler.sessionID
        }
        throw new Error('No matching helper found. Supported helpers: WebDriver/Appium/WebDriverIO')
      }
    }

    module.exports = SauceHelper
    ```

å†ä¾†å¯«åŸ·è¡Œé€™äº›è¨­å®šçš„è…³æœ¬

`package.json` è£¡ `scripts` å¢åŠ 3å€‹æ–°çš„è…³æœ¬
1. `functional::online`
1. `functional::online:localhost`
1. `start::sauce_connect`
    ```json
    "scripts": {
      "functional::online": "if codeceptjs run --steps --config=./codecept/sauce.config.js; then echo 'ğŸŠ Functional test run success'; else echo 'ğŸ’” Functional test run failure'; exit 1; fi",
      "functional::online:localhost": "export BASE_URL=http://localhost:3000/; npm run functional::online",
      "start::sauce_connect": "bin/sc -u $SAUCE_USERNAME -k $SAUCE_ACCESS_KEY"
    }
    ```

æœ€å¾Œå†ä¸‹è¼‰ä¸€å€‹ Sauce Labs æä¾›çš„ ğŸ‘‰ [sauce connect](https://wiki.saucelabs.com/display/DOCS/Basic+Sauce+Connect+Proxy+Setup#BasicSauceConnectProxySetup-SettingUpSauceConnect) ğŸ‘ˆ ï¼Œç”¨ä¾†åœ¨æœ¬æ©Ÿèµ·ä¸€å€‹é€£ç·šè®“ Sauce Labs å¯ä»¥é€éé€™å€‹é€£ç·šä¾†æ¸¬è©¦ä½  localhost çš„ç¶²ç«™ ğŸ¤©

ä¸‹è¼‰å›ä¾†çš„ sauce connect è§£å£“æ‰€å¾Œæœƒæœ‰ä¸€å€‹ bin è³‡æ–™å¤¾ï¼ŒæŠŠ bin è³‡æ–™å¤¾æ”¾åˆ°test-app-start æ ¹ç›®éŒ„å³å¯

![](./images/unzip-sauce-connect.gif)

æ¥è‘—å°±åŸ·è¡Œè…³æœ¬çœ‹çœ‹çµæœå§ï¼

å…ˆæŠŠ `sauce connect` çš„é€£ç·šèµ·èµ·ä¾†
```
$ npm run start::sauce_connect
```
ç­‰åˆ°çœ‹åˆ° `you may start your tests` çš„æ–‡å­—ï¼Œä»£è¡¨é€£ä¸Š `Sauce Labs` å¯ä»¥é–‹å§‹æ¸¬è©¦äº†ï¼Œç¢ºèªç¶²ç«™åœ¨ [localhost:3000] å¯ä»¥æ­£å¸¸é‹ä½œå¾ŒåŸ·è¡Œåº•ä¸‹è…³æœ¬
```bash
$ npm run functional::online:localhost
```

[localhost:3000]: http://localhost:3000/

sauce connect æˆåŠŸé€£ç·šå¾Œåœ¨ Sauce Labs çš„ [Tunnels](https://app.saucelabs.com/tunnels) ä¸Šæœƒçœ‹åˆ°ä¸€å€‹é€£ç·š

![](./images/sauce-connect-success.png)

åŸ·è¡ŒæˆåŠŸå¾Œåœ¨çµ‚ç«¯æ©Ÿæ‡‰è©²å¯ä»¥çœ‹åˆ° ã€ŒğŸŠ Functional test run successã€

æ³¨æ„åˆ°é€™å€‹äº†å— ğŸ‘‡ğŸ‘‡ğŸ‘‡ï¼Ÿå¯ä»¥ç›´æ¥é€£åˆ° Sauce Labs çœ‹æ¸¬è©¦çµæœï¼

ã€Œâš¡ï¸ Test finished. Link to job: [https://saucelabs.com/jobs/36b1290a5c1e4f7ea93d53535bdc32ee](https://saucelabs.com/jobs/36b1290a5c1e4f7ea93d53535bdc32ee) âš¡ï¸ã€

![](./images/functional-result-with-link.png)

é€²å…¥[é€£çµ](https://saucelabs.com/jobs/36b1290a5c1e4f7ea93d53535bdc32ee)å¾Œå¯ä»¥ç›´æ¥çœ‹åˆ°æ¸¬è©¦çš„éç¨‹

![](./images/functional-result-in-saucelabs.png)

å¦å¤–å¯ä»¥çœ‹åˆ° Sauce Labs çš„ [Dashboard](https://app.saucelabs.com/dashboard/builds) ä¸Šæ•´å€‹æ¸¬è©¦åŸ·è¡ŒæˆåŠŸ

![](./images/functional-result-in-dashboard.png)

é€™æ¨£æœ¬æ©Ÿé€£ç·š Sauce Labs çš„æ¸¬è©¦å°±å®Œæˆäº†ï¼Œä¸Šé¢æåˆ°çš„ç‹€æ³2ï¼Œéœ€è¦å°‡ç¶²ç«™éƒ¨ç½²åˆ°ç·šä¸Šæ‰èƒ½åŸ·è¡Œï¼Œå› æ­¤æœƒç­‰åˆ°æœ€çµ‚è¨­å®šå¥½æŒçºŒæ•´åˆæ™‚å†é€²è¡Œå±•ç¤ºã€‚

å±•ç¤ºï¼š[Update for compatibility test](https://github.com/sky172839465/test-app-starter/commit/0aeba496655ab059746c72eb1eb82d6fb4cd579c)

## Deploy

è‡ªå‹•éƒ¨ç½²æœ€å¥½çš„åœ°æ–¹å°±æ˜¯ä¸ç”¨æ“”å¿ƒå°‘æŠ“ä¸€å€‹æª”æ¡ˆã€å¤šåˆªä¸€å€‹æª”æ¡ˆä¹‹é¡çš„æƒ…æ³ï¼Œç•¢ç«Ÿçœ¼æ®˜æ‰‹è³¤çš„æƒ…æ³å¯¦åœ¨å¤ªå¤šäº†â€¦ğŸ™„

é¦–å…ˆæˆ‘å€‘éœ€è¦å–å¾—å­˜å– GitHub çš„é‡‘é‘°ï¼Œé€™æ¨£ GitHub æ‰æœƒå…è¨±æˆ‘å€‘å° GitHub Pages é€²è¡Œä¿®æ”¹ï¼Œé€™è£¡æœ‰å®˜æ–¹[ç”¢ç”Ÿ GITHUB_TOKEN çš„æ–‡ä»¶](https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/)å¯ä»¥åƒè€ƒ

é¦–å…ˆé€²å…¥ç”¢ç”Ÿ [GITHUB_TOKEN çš„é é¢](https://github.com/settings/tokens)é»å³ä¸Šè§’ã€ŒGenerate new tokenã€

![](./images/generate-github-token.png)

æ¥è‘—è¼¸å…¥æè¿°èˆ‡å‹¾é¸ repo é¸é …ï¼Œæè¿°æ˜¯ç‚ºäº†è®“è‡ªå·±çŸ¥é“é€™å€‹é‡‘é‘°çš„åŠŸèƒ½ï¼Œ repo æ˜¯é€™å€‹ GITHUB_TOKEN è¢«è³¦äºˆçš„å­˜å–æ¬Šé™ï¼Œè¼¸å…¥å®Œæˆå¾ŒæŒ‰åº•ä¸‹çš„ã€ŒGenerate tokenã€

![](./images/new-github-token.png)

ç”¢ç”Ÿå‡ºä¾†çš„ GITHUB_TOKEN è¨˜å¾—é¦¬ä¸Šå­˜èµ·ä¾† âœï¸ï¼Œå› ç‚ºä¹‹å¾Œå°±çœ‹ä¸åˆ°äº†ï¼Œåªèƒ½åˆªé™¤é€™å€‹ GITHUB_TOKEN æˆ–é‡æ–°ç”¢ç”Ÿä¸€å€‹

![](./images/record-github-token.png)

> GITHUB_USER_NAME = ä½ çš„ GitHub å¸³è™Ÿ

GITHUB_REPO_REF = `github.com/<GITHUB_USER_NAME>/test-app-starter.git`

å„²å­˜ `GITHUB_TOKEN` å’Œ `GITHUB_REPO_REF` 
```bash
# mac
$ export GH_TOKEN=GITHUB_TOKEN GH_REF=GITHUB_REPO_REF
# windows
$ set GH_TOKEN=GITHUB_TOKEN GH_REF=GITHUB_REPO_REF
```
`package.json` è£¡
1. æ–°å¢ `homepage` è¨­å®š
1. `scripts` ä¿®æ”¹ `build` ä¸¦æ–°å¢ `deploy::prod` è…³æœ¬
```json
"homepage": "https://<GITHUB_USER_NAME>.github.io/test-app-starter/",
"scripts": {
  "build": "if react-scripts build; then echo 'ğŸ˜ Build success'; else echo 'ğŸ˜¨ Build failure'; exit 1; fi",
  "deploy::prod": "npm run build && if bash ./ghpage-deploy.sh; then echo 'ğŸ¤— Deploy success'; else echo 'ğŸ˜± Deploy failure'; exit 1; fi"
}
```

æ–°å¢ä¸€å€‹æª”æ¡ˆåˆ° test-app-starter æ ¹ç›®éŒ„

`./ghpage-deploy.sh`

ğŸ‘‰ `<YOUR_EMAIL>` è¨˜å¾—æ›¿æ›æˆè‡ªå·±çš„ä¿¡ç®± ex: test-app@gmail.com ğŸ‘ˆ
```bash
cd build
git init
git config user.name "Travis CI"
git config user.email "<YOUR_EMAIL>"
git add .
git commit -m "Deploy to GitHub Pages"
git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:gh-pages > /dev/null 2>&1
```

åŸ·è¡Œå¾ŒæœƒæŠŠç¾æœ‰ç¶²ç«™å£“ç¸®æ‰“åŒ…ï¼Œç„¶å¾Œä¸Šå‚³åˆ° GitHub Pages ä¸Šï¼Œé€™è£¡çš„è…³æœ¬ä¸Šå‚³åˆ° GitHub Pages çš„ä½ç½®å°±æ˜¯ `<GITHUB_USER_NAME>.github.io/test-app-starter`
```bash
$ npm run deploy::prod
```

åŸ·è¡ŒæˆåŠŸå¾Œåœ¨çµ‚ç«¯æ©Ÿæ‡‰è©²å¯ä»¥çœ‹åˆ°ã€ŒğŸ¤— Deploy successã€

æˆ‘çš„ GITHUB_USER_NAME æ˜¯ yusong-demo æ‰€ä»¥æˆ‘çš„ç¶²ç«™å°±åœ¨ ğŸ‘‰ [https://yusong-demo.github.io/test-app-starter](https://yusong-demo.github.io/test-app-starter)

![](./images/deploy-to-gh-page.png)

å±•ç¤ºï¼š[Update for deploy](https://github.com/sky172839465/test-app-starter/commit/d36bcd1ae7e9bfd8c87db406651b34d9cc409db6)

## Continuous integration

çµ‚æ–¼èµ°åˆ°æœ€å¾Œä¸€æ­¥ï¼ŒæŒçºŒæ•´åˆï¼Œè®“æˆ‘å€‘è¿…é€Ÿè§£æ±ºä»–å§ ğŸ˜

Travis CI æ˜¯ä¸€å¥—æŒçºŒæ•´åˆçš„å·¥å…·ï¼Œä»–å¯ä»¥è®“ä½ é€£çµ GitHub å¸³è™Ÿå¾Œé¸æ“‡æŒ‡å®šçš„å°ˆæ¡ˆçµ¦ä»–æ›ä¸Šä¸€å€‹äº‹ä»¶ç›£è½ï¼Œé€™å€‹äº‹ä»¶ç›£è½å¯ä»¥åœ¨ master åˆ†æ”¯è¢« merge çš„æ™‚å€™è§¸ç™¼ã€å¯ä»¥åœ¨ PR (pull request)ç™¼å‡ºä¾†çš„æ™‚å€™è§¸ç™¼ï¼Œè§¸ç™¼ä¹‹å¾Œå°±åŸ·è¡Œä¸Šé¢ä¸€æ‹–æ‹‰åº«çš„è…³æœ¬ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥ä¿è­‰æ¯æ¬¡ç™¼å¸ƒæ–°ç‰ˆæœ¬çš„æ™‚å€™ï¼Œè©²æ¸¬çš„æ±è¥¿éƒ½æ¸¬äº†ï¼Œé€™æ¨£ä¸Šç·šé‚„æœ‰å•é¡Œå°±èƒ½å…ˆæ¨çµ¦å¾Œç«¯è™•ç†äº† ğŸ˜ˆ

é¦–å…ˆæˆ‘å€‘è¦åˆ° [Travis CI](https://travis-ci.org/) è¨»å†Šå¸³è™Ÿï¼Œè¨˜å¾—è¦ç”¨ GitHub å¸³è™Ÿè¨»å†Šï¼Œ Travis CI æ‰èƒ½å–å¾—ä½ çš„å¸³è™Ÿä¸¦ç›£è½æŒ‡å®šçš„å°ˆæ¡ˆ

![](./images/travis-ci-register.png)

è¨»å†Šå®Œæˆå¾Œï¼Œé€²å…¥ [Travis CI å°ˆæ¡ˆåˆ—è¡¨](https://travis-ci.org/account/repositories)çš„é é¢ï¼ŒæŠŠ test-app-starter å•Ÿå‹•ä¸¦é»é¸ test-app-starter é€™å€‹é¸é …å°±æœƒé€²å…¥é€™å€‹å°ˆæ¡ˆçš„å»ºç½®é é¢

![é»é¸é–‹é—œå•Ÿå‹•é€™å€‹å°ˆæ¡ˆ](./images/travis-ci-enable-project.png)

é€²å…¥ test-app-starter å°ˆæ¡ˆå»ºç½®é é¢ï¼Œé»Settings ï¼Œ è¨­å®šç’°å¢ƒè®Šæ•¸ (Environment Variables)

![é» Settings](./images/travis-ci-settings.png)

éœ€è¦è¨­å®šçš„ç’°å¢ƒè®Šæ•¸å³å‰é¢æ­¥é©Ÿæœ‰ export / set çš„éƒ½éœ€è¦ï¼Œé€™é‚Šæ•´ç†ä¸€ä»½çµ¦å¤§å®¶æ ¸å°ä¸€ä¸‹

* EYES_KEY
* GH_REF
* GH_TOKEN
* SAUCE_ACCESS_KEY
* SAUCE_USERNAME

æœ€å¾Œæˆ‘å€‘è¦æ–°å¢ Travis CI çš„è¨­å®šæª”åœ¨ test-app-starter çš„æ ¹ç›®éŒ„åº•ä¸‹ï¼Œä»–çš„æ ¼å¼æ˜¯ yml ï¼Œå…¶å¯¦é€™ç¨®æ ¼å¼è·Ÿ JSON å·®ä¸å¤šï¼Œä¸è«‹æ¥šçš„è©±ä¸Šç¶²æŸ¥ä¸€ä¸‹é¦¬ä¸Šå°±ç­è§£äº†

`./.travis.yml`
```yaml
language: node_js
node_js:
  - stable
addons:
  sauce_connect: true
cache:
  directories:
    - node_modules
install:
  - npm install
script:
  - echo "npm test temporarily disabled"
  - npm run lint
  - npm run test
  - npm run deploy::prod
  - npm run functional::online
true:
  branch: master
```

æŠŠ test-app-starter æ‰€æœ‰çš„è®Šæ›´ commit ä¸¦ push åˆ°è‡ªå·±çš„ GitHub ä¸Šï¼Œæ¥è‘— Travis CI å°±æœƒå› ç‚º master push è§¸ç™¼ï¼Œé–‹å§‹åŸ·è¡Œ yml ä¸­çš„è¨­å®š

![](./images/travis-ci-running.png)

åŸ·è¡ŒæˆåŠŸå¾Œåœ¨ Travis CI çš„çµ‚ç«¯æ©Ÿç•«é¢ä¸Šæ‡‰è©²æœƒçœ‹åˆ°è·Ÿé€™å€‹ [demo](https://travis-ci.org/yusong-demo/test-app-starter/builds/489649280) ä¸€æ¨£çš„çµæœ

![](./images/travis-ci-success.png)

å±•ç¤ºï¼š[Update for continuous integration](https://github.com/sky172839465/test-app-starter/commit/44787c15a89843f7d750adbe8e7c68b73386e310)

ğŸ‰ ğŸ»æ­å–œä½ å®Œæˆäº†é€™ä¸€ç³»åˆ—çš„æ¸¬è©¦ ğŸ» ğŸ‰

ä¹‹å¾Œæ¯æ¬¡æˆ‘å€‘åªè¦ push æ–°çš„ code åˆ° master branch å°±æœƒè§¸ç™¼ Lint test ã€ Unit test ã€ Functional test ã€ Compatibility test ä»¥åŠéƒ¨ç½²åˆ°ç·šä¸Šç’°å¢ƒï¼Œé€™æ¨£ä¸€ä¾†æ–°ç‰ˆç¶²ç«™ä¸Šç·šå°‡æœƒå› ç‚ºç¶“éçœ¾å¤šæ¸¬è©¦çš„æ´—ç¦®è®Šå¾—æ›´ç©©å®šä¸”æ›´å°ˆæ³¨æ–¼é–‹ç™¼ä¸Š (ç†æƒ³ä¸Š ğŸ˜…)ã€‚

## Bonus ğŸ

é‚£éº¼â€¦åšäº†é€™éº¼å¤šè‡ªå‹•æ¸¬è©¦ï¼Œé›£é“éƒ½åªæœ‰é–‹ç™¼è€…çŸ¥é“å—ï¼Ÿæœ‰æ²’æœ‰ä»€éº¼è¾¦æ³•è®“å…¶ä»–ä½¿ç”¨è€…ä¸€çœ‹å°±èƒ½å®‰å¿ƒçš„æ–¹å¼å‘¢ï¼Ÿç•¶ç„¶æœ‰å•¦ï¼

![](./images/status-banner.png)

![](./images/compatibility-banner.png)

Badge é€™æ˜¯å¸¸å¸¸å¯ä»¥åœ¨ç†±é–€ Open source ä¸­çœ‹åˆ°çš„åœ–ç¤ºï¼Œä»–æ¸…æ¥šçš„é»å‡ºäº†é€™å€‹å°ˆæ¡ˆå—éå“ªäº›æ¸¬è©¦æˆ–æ˜¯ä»–å€‘ç¬¦åˆå“ªäº›è¦ç¯„ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å°±å°‡ä¸Šé¢æ¸¬è©¦çš„çµæœéƒ½åŠ ä¸Š badge ç¾åŒ–ä¸€ä¸‹ README.md å§ ğŸ˜‹

* Lint test : StandardJS æœ‰æä¾›ä¸€å€‹[éœæ…‹çš„ badge](https://standardjs.com/#is-there-a-readme-badge) å¯ä»¥ç›´æ¥ç”¨

[![JavaScript Style Guide][standard-image]][standard-url]

[standard-image]: https://img.shields.io/badge/code_style-standard-brightgreen.svg
[standard-url]: https://standardjs.com
```markdown
[![JavaScript Style Guide][standard-image]][standard-url]

[standard-image]: https://img.shields.io/badge/code_style-standard-brightgreen.svg
[standard-url]: https://standardjs.com
```

* Unit test : Jest åŸ·è¡Œå®Œæœƒç”¢ç”Ÿä¸€å€‹è¦†è“‹ç‡çš„è³‡æ–™å¤¾ï¼Œåªè¦æŠŠè£¡é¢çš„æ±è¥¿ä¸Šå‚³åˆ° [Codecov](https://codecov.io/) å°±èƒ½åœ¨æ¯æ¬¡ Travis CI åŸ·è¡Œå®Œç”¢ç”Ÿå°æ‡‰çš„ coverage badge !

[![Coverage Status][codecov-image]][codecov-url]

```markdown
[![Coverage Status][codecov-image]][codecov-url]

[codecov-image]: https://img.shields.io/codecov/c/github/<CODECOV_USER_NAME>/test-app.svg
[codecov-url]: https://codecov.io/gh/<CODECOV_USER_NAME>/test-app
```
å®‰è£ Codecov ä¾è³´å¥—ä»¶
```bash
$ npm install --save-dev codecov
```
`.travis.yml` è£¡ `script` ä¿®æ”¹ `npm run test` è…³æœ¬
```yml
script:
  - npm run test && codecov
```
åˆ° [Codecov] è¨»å†Šå¸³è™Ÿ
[![SignIn Codecov][signin-codecov-image]][signin-codecov-url]
åŒæ„å­˜å– GitHub æ¬Šé™
![Accept Codecov][accept-codecov-image]
æ‰¾åˆ° test-app-starter å°ˆæ¡ˆé»ä¸‹å»

![Select Repo][select-repo]

å–å¾— CODECOV_TOKEN
![Get Token][get-token]
æŠŠ CODECOV_TOKEN å­˜åˆ° Travis CI è£¡çš„ Environment Variables 

[codecov-image]: https://img.shields.io/codecov/c/github/sky172839465/test-app.svg
[codecov-url]: https://codecov.io/gh/sky172839465/test-app
[signin-codecov-image]: https://user-images.githubusercontent.com/9082423/52392435-c357e580-2adc-11e9-86ff-d2fdb69836d8.png
[signin-codecov-url]: https://codecov.io/gh
[Codecov]: https://codecov.io/gh
[accept-codecov-image]: https://user-images.githubusercontent.com/9082423/52392611-9eb03d80-2add-11e9-88df-0574fdcf8999.png
[select-repo]: https://user-images.githubusercontent.com/9082423/52392872-b3410580-2ade-11e9-9fa8-841cc11972e6.png
[get-token]: https://user-images.githubusercontent.com/9082423/52392961-16cb3300-2adf-11e9-941c-dde1b5ae800d.png

* Functional test : Sauce Labs åŸ·è¡Œå®Œæˆå¾Œæœƒå› ç‚ºæˆ‘å€‘åœ¨ sauceHelper.js åšäº†æ›´æ–°Jobçš„å‹•ä½œè®Šæˆ pass / fail ï¼Œå¦‚æœæ²’æœ‰æ‰‹å‹•æ›´æ–°è·‘å®Œä¸è«–æˆåŠŸå¤±æ•—éƒ½æœƒæ˜¯ completeï¼ŒæŸ¥çœ‹æ¸¬è©¦çµæœéœ€è¦ç”³è«‹ [Open Sauce](https://saucelabs.com/open-source/) æ‰èƒ½è®“æ‰€æœ‰äººç€è¦½æ¸¬è©¦çµæœ

[![Saucelabs Ststus][sauce-labs-status-image]][sauce-labs-status-url]

[sauce-labs-status-image]: https://saucelabs.com/buildstatus/test-app
[sauce-labs-status-url]: https://saucelabs.com/u/test-app
```markdown
[![Saucelabs Ststus][sauce-labs-status-image]][sauce-labs-status-url]

[sauce-labs-status-image]: https://saucelabs.com/buildstatus/<SAUCE_USER_NAME>
[sauce-labs-status-url]: https://saucelabs.com/u/<SAUCE_USER_NAME>
```

* Compatibility test : åŒæ¨£æ˜¯ Sauce Labs æä¾›çš„ badge ï¼Œå¦‚æœæ¸¬è©¦å¤šå€‹ç€è¦½å™¨å°±å¯ä»¥ç”¨é€™å€‹ badge æ¸…æ¥šè¡¨é”æ”¯æ´å“ªäº›ç€è¦½å™¨

[![Saucelab Compatibility][compatibility-image]][compatibility-url]

[compatibility-image]: https://saucelabs.com/browser-matrix/test-app.svg
[compatibility-url]: https://saucelabs.com/u/test-app
```markdown
[![Saucelab Compatibility][compatibility-image]][compatibility-url]

[compatibility-image]: https://saucelabs.com/browser-matrix/<SAUCE_USER_NAME>.svg
[compatibility-url]: https://saucelabs.com/u/<SAUCE_USER_NAME>
```

* CI statusï¼šTravis CI æä¾›çš„ badgeï¼Œæœ‰é€™å€‹æ¸¬è©¦å¯ä»¥ä¸€çœ‹å°±çŸ¥é“æœ€å¾Œä¸€æ¬¡è·‘çš„æ¸¬è©¦æœ‰æ²’æœ‰æˆåŠŸ

[![Build Status][travis-image]][travis-url]

[travis-image]: https://img.shields.io/travis/sky172839465/test-app.svg
[travis-url]: https://travis-ci.org/sky172839465/test-app

```markdown
[![Build Status][travis-image]][travis-url]

[travis-image]: https://img.shields.io/travis/<TRAVIS_USERNAME>/test-app.svg
[travis-url]: https://travis-ci.org/<TRAVIS_USERNAME>/test-app
```

## A short version ğŸ˜

å»ºè­°æ˜¯æŒ‰ç…§æ•´å€‹æµç¨‹èµ°ä¸€æ¬¡çœ‹éæ–‡ç« ä¸­è¨­å®šçš„ç¨‹å¼ç¢¼æ€éº¼é‹ä½œï¼Œåœ¨ä½¿ç”¨ä¸Šæ¯”è¼ƒå®¹æ˜“å…§ç‚ºå·±ç”¨ï¼Œä½†æ˜¯â€¦æˆ‘åªæ˜¯æƒ³è¦é«”é©—çœ‹çœ‹æœ‰æ²’æœ‰å…¶ä»–æ‡¶äººåŒ…å‘¢ï¼Ÿç•¶ç„¶æœ‰å•¦ï¼

[test-app](https://github.com/sky172839465/test-app) å·²ç¶“æŠŠä¸Šé¢çš„è¨­å®šå®Œå…¨èµ°éä¸€æ¬¡ï¼Œåªè¦æ”¹æˆä½¿ç”¨é€™å€‹å°ˆæ¡ˆå°±åªéœ€è¦æŠŠè©²è¨»å†Šçš„ç¶²é è¨»å†Šï¼Œè©²å­˜çš„ TOKEN å­˜åˆ° Travis CI ä¸Šé¢å°±å¯ä»¥é †åˆ©åŸ·è¡ŒæŒçºŒæ•´åˆäº†ï¼

è¨­å®šæ–¹å¼å°±è«‹ç›´æ¥åƒè€ƒå°ˆæ¡ˆä¸Šçš„ [Quick Start](https://github.com/sky172839465/test-app#quick-start) å§ï¼

## çµè«–

é€™ä¸€æ•´å¥—æµç¨‹é›–ç„¶å¾ˆç¹ç‘£ï¼Œä½†æ˜¯é•·é ä¾†çœ‹å¯ä»¥å¸¶ä¾†è«å¤§çš„å¥½è™•(ä¸ç”¨ä¸Šç·šæ€•å¾—è¦æ­»)ï¼Œä½†æ˜¯â€¦ç¸½æ˜¯æœ‰å€‹ä½†æ˜¯ï¼Œå°±æ˜¯é–‹ç™¼äººå“¡å¿…é ˆéµå®ˆç´€å¾‹å¥½å¥½çš„æ’°å¯«æ¸¬è©¦ï¼Œé–‹ç™¼æ™‚é–“éƒ½ä¸å¤ äº†é‚„è¦å¯«æ¸¬è©¦ï¼Ÿéš•çŸ³é–‹ç™¼æ³•å¯«æ¸¬è©¦ï¼Ÿå³ä½¿æœ‰æœ‰å„å¼å„æ¨£çš„ç‚ºé›£å­˜åœ¨ï¼Œåªè¦æƒ³ä¸€ä¸‹ã€Œä¸‹ç­æ™‚ç™¼ç¾ä¸Šç·šçš„ç¶²ç«™æœ‰å•é¡Œï¼Œè«‹ä»Šæ—¥ä¿®å¾©ã€ï¼Œä¸€è‚¡é›£ä»¥è¨€å–»çš„å‹•åŠ›å°±ç”¢ç”Ÿäº† ğŸ˜‰ï¼Œæœ‰æ™‚é–“ã€æœ‰èˆˆè¶£ã€æœ‰éœ€æ±‚çš„å·¥ç¨‹å¸«å€‘éƒ½æ‡‰è©²ä¾†è©¦è©¦çœ‹ï¼

æœ€å¾Œâ€¦é€™ç¯‡æ–‡ç« å¦‚æœæœ‰ä»€éº¼å¯«éŒ¯æˆ–å¯ä»¥æ”¹å–„çš„åœ°æ–¹æ­¡è¿å„ä½ç•™è¨€ ğŸ™Œ

Update 2019.03.10 Unit test failed

ç¾åœ¨ NodeJS v11.11.x åœ¨åŸ·è¡Œæ™‚æœƒèˆ‡ Jest v23 ç”¢ç”Ÿè¡çªå°è‡´ Travis CI build failingï¼Œå› æ­¤å»ºè­°å…ˆå°‡ .travis.yml çš„ NodeJS é™ç‰ˆï¼Œç­‰[å•é¡Œ](https://github.com/facebook/create-react-app/issues/6591)è§£æ±ºå¾Œå†æ”¹å›æœ€æ–°ç‰ˆçš„ NodeJSã€‚

```yml
language: node_js
node_js:
  - 11.10.1
```

Tipsï¼šåœ¨é€™å€‹[å•é¡Œ](https://github.com/facebook/create-react-app/issues/6591)ä¸­å¯ä»¥é» Subscribe è¨‚é–±é€™å€‹å•é¡Œçš„è™•ç†é€²åº¦ï¼Œæ‰èƒ½åœ¨è§£æ±ºæ™‚æ”¶åˆ° mail é€šçŸ¥å–” ğŸ˜‰

![](./images/issue-subscribe.png)

å±•ç¤ºï¼š[Fix unit test fail](https://github.com/sky172839465/test-app/commit/91cccf39897cd8367f4b67bab203a8953ccc3540)
